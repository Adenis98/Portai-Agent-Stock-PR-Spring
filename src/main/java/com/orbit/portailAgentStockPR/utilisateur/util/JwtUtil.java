package com.orbit.portailAgentStockPR.utilisateur.util;

import io.jsonwebtoken.Claims;

import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.SignatureAlgorithm;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.stereotype.Service;

import java.util.Date;
import java.util.HashMap;
import java.util.Map;
import java.util.function.Function;

@Service
public class JwtUtil {

    private String SECRET_KEY = "secret";

    public JwtUtil() {
    }

    public String extractUsername(String token) {
        return extractClaim(token, Claims::getSubject);
    }

    public Date extractExpiration(String token) {
        return extractClaim(token, Claims::getExpiration);
    }

    public <T> T extractClaim(String token, Function<Claims, T> claimsResolver) {
        final Claims claims = extractAllClaims(token);
        return claimsResolver.apply(claims);
    }
    private Claims extractAllClaims(String token) {
        return Jwts.parser().setSigningKey(SECRET_KEY).parseClaimsJws(token).getBody();
    }

    private Boolean isTokenExpired(String token) {
        return extractExpiration(token).before(new Date());
    }

    public String generateToken(UserDetails userDetails) {
        Map<String, Object> claims = new HashMap<>();
        claims.put("img","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAABSCAYAAAC2eC1AAAAYQmlDQ1BJQ0MgUHJvZmlsZQAAWIWVWQdUVEmz7juRgRlyzjnnHCTnJDkjMAxpyJJBEAVECSuYUAFFkogkwQAiIiBBFEGCgGAAFBRExYCCpHcBdff/95z3zus5fe831dVV1d3V1V0zAHAoEsPDgxG0AISERkXYGuvxOru48mJnAbTzEQKMRFJkuK61tQWAy+/3f5bvozAnXIaltmX9u/1/LXQ+vpEkACBrGHv7RJJCYHwDAJQyKTwiCgD0IkwXiI0KhzEGthIwRsAGwlhwG/vvYtVt7L2LLXZ47G31YewFAAWeSIzwB4B62y7eGJI/LIc6G26jD/Uhh8Ksl2CsRQog+gDAPgXzSIaEhMGYAw9jUe9/yPH/D5nef2QSif5/8O5YdgqFATkyPJgY//+cjv+7hARH/9YhAFd8QISJ7faYt+ctKMx8G8O2Qw9CvfdawZgexiNknx3+bTwXEG3i8It/hRSpD88ZYAYAgfchGpjDmBPG/KHBey1+0bX8yEamMIbnHmFPjjK13+2L8IkIs/0lHxHnG2lo9xsTI3Z0bfNkRgc56P6SeTHA1/S3zOaEAHunXTsRT2LIjnthTA3j55FBdua/eBYSAvT3/uaJiLbdthlecyTwizCy3eVBCoZE/h4XUj2AbLr3F7YgEXfsYYWxR1SAvcmuHGSMb6SzxW87fXwNDHfHhUzxDXX4ZT/yZHiUnu2vvmXhwda/+JEtvsHG23R+GPdHxtj97rsUBTvb7nhRIDzK2n7XNhRjINHMelcvShxYAH1gAHhBNFy9QRgIBOT+xcZF+NtuixEgggjgD3yB1C/K7x5OOy2h8NMOJIAPMPIFkX/66e20+oIYmL7xh7r7lAJ+O60xOz2CwByMQ4A5CIa/R+/0Cv2jzRG8gSnkf2knwbYGw3W77V80XprfNIwhxgBjgjHCiKHYUVooDZQF/NSBqzxKFaX2266/+dFz6EH0DPopegr9zJOcEvFflvMCSzAF22j0a3Te/xwdShiWqoTSQ2nC8mHZKGYUO5BCKcKadFHasG4lmPpPW6P/jPjvufwlCyeLQ+BYcDo40X9ZsD07/xz/Lzq1OLXSL7u8/8yW/h+u/5ai/4/584Hf5v/NiTyGvI7sQbYje5EtyEbAi7yHbEL2Ie9u4z++8WbHN35rs92xLQiWQ/6XPuIvnduzFilbJTsvu/6rDUT5xkVtbxb9sPD4CLJ/QBSvLhytfXlNQ0nSkrzysvJyAGzH/t3Q8tV2J6ZDzAN/08ijACjXw8Txv2n+sL83zwCAs/ibJlQNb2c4tj7AkaIjYnZpqO0HGlACGninsAFuOHaJwiOSB8pAA+gAQ2AGrIA9cAEe8JwHwH4aAWJBIjgM0kEWyAVnQD4oAqXgCqgBDaARtIB20A0egSfgKZiEfWUWvAdL4DtYgyAICxEgBogN4oGEIAlIHlKFtCBDyAKyhVwgL8gfCoWioUQoFcqCTkL5UDFUCdVDt6F2qBcahJ5B09A89AX6iUAi8AhGBBdCGCGDUEXoIswR9oh9CH/EfkQCIg1xHHEOUYKoRtxCtCMeIZ4iphDvEctIgKRCMiP5kFJIVaQ+0grpivRDRiAPIjORecgSZC2yGV7pYeQUchG5isKgGFC8KCnYX01QDigSaj/qICoblY+6grqF6kQNo6ZRS6hNNAHNiZZAq6NN0c5of3QsOh2dh76MvonugvfOLPo7BoNhxohgVOC954IJxBzAZGMuYOowbZhBzGvMMhaLZcNKYDWxVlgiNgqbjj2Prcbeww5hZ7ErFFQUPBTyFEYUrhShFCkUeRRXKVophijeUqzhaHFCOHWcFc4HF4/LwZXhmnEDuFncGiUdpQilJqU9ZSDlYcpzlLWUXZTPKb9SUVHxU6lR2VCRqQ5RnaO6RvWAappqFU+PF8fr493x0fjj+Ap8G/4Z/iuBQBAm6BBcCVGE44RKwn3CS8IKNQO1NLUptQ91MnUB9S3qIeqPNDgaIRpdGg+aBJo8mus0AzSLtDhaYVp9WiLtQdoC2tu0Y7TLdAx0cnRWdCF02XRX6Xrp3tFj6YXpDel96NPoS+nv079mQDIIMOgzkBhSGcoYuhhmGTGMIoymjIGMWYw1jP2MS0z0TIpMjkxxTAVMd5mmmJHMwsymzMHMOcwNzKPMP1m4WHRZfFkyWGpZhlh+sHKw6rD6smay1rE+Zf3JxstmyBbEdoKtke0FO4pdnN2GPZb9InsX+yIHI4cGB4kjk6OBY4ITwSnOact5gLOUs49zmYuby5grnOs8132uRW5mbh3uQO7T3K3c8zwMPFo8ZJ7TPPd4FniZeHV5g3nP8XbyLvFx8pnwRfMV8/XzrfGL8Dvwp/DX8b8QoBRQFfATOC3QIbAkyCNoKZgoWCU4IYQTUhUKEDor1CP0Q1hE2En4qHCj8DsRVhFTkQSRKpHnogRRbdH9oiWiI2IYMVWxILELYk/EEeJK4gHiBeIDEggJZQmyxAWJQUm0pJpkqGSJ5JgUXkpXKkaqSmpamlnaQjpFulH6o4ygjKvMCZkemU1ZJdlg2TLZSTl6OTO5FLlmuS/y4vIk+QL5EQWCgpFCskKTwmdFCUVfxYuK40oMSpZKR5U6lDaUVZQjlGuV51UEVbxUClXGVBlVrVWzVR+oodX01JLVWtRW1ZXVo9Qb1D9pSGkEaVzVeLdHZI/vnrI9rzX5NYmaxZpTWrxaXlqXtKa0+bSJ2iXaMzoCOj46l3Xe6orpBupW637Uk9WL0Lup90NfXT9Jv80AaWBskGnQb0hv6GCYb/jSiN/I36jKaMlYyfiAcZsJ2sTc5ITJmCmXKcm00nTJTMUsyazTHG9uZ55vPmMhbhFh0WyJsDSzPGX5fK/Q3tC9jVbAytTqlNULaxHr/dZ3bDA21jYFNnO2craJtj12DHaedlftvtvr2efYTzqIOkQ7dDjSOLo7Vjr+cDJwOuk05SzjnOT8yIXdhezS5Ip1dXS97LrsZuh2xm3WXck93X10n8i+uH29HuwewR53PWk8iZ7XvdBeTl5XvdaJVsQS4rK3qXeh9xJJn3SW9N5Hx+e0z7yvpu9J37d+mn4n/d75a/qf8p8P0A7IC1gk65PzyZ8DTQKLAn8EWQVVBG0FOwXXhVCEeIXcDqUPDQrtDOMOiwsbDJcITw+f2q++/8z+pQjziMuRUOS+yKYoRviS3RctGn0kejpGK6YgZiXWMfZ6HF1caFxfvHh8RvzbBKOE8gOoA6QDHYl8iYcTp5N0k4oPQge9D3YkCySnJc8eMj505TDl4aDDj1NkU06mfEt1Sm1O40o7lPb6iPGRqnTq9Ij0saMaR4uOoY6Rj/VnKGScz9jM9Ml8mCWblZe1nk3KfviX3F/n/to67ne8P0c552IuJjc0d/SE9okrJ+lOJpx8fcry1K3TvKczT38743mmN08xr+gs5dnos1PnLM41nRc8n3t+PT8g/2mBXkFdIWdhRuGPCz4Xhi7qXKwt4irKKvp5iXxpvNi4+FaJcEleKaY0pnSuzLGsp1y1vPIy++WsyxsVoRVTV2yvdFaqVFZe5byaU4Woiq6ar3avflJjUNNUK1VbXMdcl3UNXIu+tlDvVT/aYN7QcV31eu0NoRuFNxluZt6CbsXfWmoMaJxqcmkavG12u6NZo/nmHek7FS18LQV3me7mtFK2prVu3Uu4t9wW3rbY7t/+usOzY/K+8/2RTpvO/i7zrgfdRt33e3R77j3QfNDSq957+6Hqw8ZHyo9u9Sn13Xys9Phmv3L/rQGVgaYnak+aB/cMtg5pD7UPGwx3j5iOPHq69+ngqMPo+Jj72NS4z/i7Z8HPPk/ETKxNHnqOfp75gvZF3kvOlyWvxF7VTSlP3Z02mO6bsZuZfE16/f5N5Jv12bQ5wlzeW563le/k37XMG80/WXBbmH0f/n5tMf0D3YfCj6Ifb3zS+dS35Lw0+zni89aX7K9sXyu+KX7rWLZefvk95Pvaj8wVtpUrq6qrPT+dfr5di13Hrp/bENto3jTffL4VsrUVTowg7lwFkHBF+PkB8KUCAIILAAxPAKB0283NfhUkfPlAwG9HSBp6j+hERqKEUAvoYownlg87SVGCC6SUp1ynGsAXEaKo99KI0WJoZ+i66C8zZDCGMTkyG7I4sYawpbNf4mjmHOJa5MHxCvLp8nsJJAkWCN0WnhD5KcYhriXhLZkqVSk9IPNVjlVeW4GkmKVUrzyo8lGNoC6uYbTHW/OgVr72DZ1+3bd6mwashtJGBsZOJkGmiWbHzS9a1Fre3dtnNWE9Z/PNDrLHO7A4cjrxOAu4iLhKusm7q+/T9zD3dPAiEcO8D5L+8inyrffr8p8IWAqkCOINVguxCw0Lywwv398e8TJyLZo1RinWPm5/fG5C3YGBxE8HaZMVDjkcjkspTG1Pm0vHH1U45pqRklmZNZy9flw4xyo3/kTZycenPp2hyZM763Au7nxhfnvB2wuEi0pF7pdSi6+WDJb+KOe8rFvhe+Vo5ZWrPVVvqrdqWetkrxnXuzdEXM+4cfHmtVstjfebum/fb75zp6Yl/+7hVtI9nTaWtoX22x2H7xt34jofdqV363av9dx4ENTL3zvx8MQjiz583+DjvH7XAe6BmSdlg35DokPzw1dHAp+KP30/WjUWNC45/uFZ3cT+ScXJlectLw6/NHpFeDUylT/tMcM/M//65pujs55zmm8F3tHOoxcQ7ykXOT6ofHT7dHSp+fO3r4rf4pZbf2BXbFYLf86tS29EbzZvbe2svwB0DeGCpEM2oNzQlOgajDN8q6mjIOJYcY8o06j08Gj8fcIRalMaappx2hK6YHoVBizDC8Y+pm7mNpa7rE1s19mvcVRzVnCVcZfylPKW8BXzlwiUCVYIVQrXiNSL3hBrFm+X6JJ8KDUkPS7zQval3Av55woTimNKT5WHVQZUH6p1qbdr3NlzQ7NGq0w7XydHN1UvVj/QYJ/hXiMdYzkTXlNaM2C2ZP7cosuyeu8pqwPW3jamtrJ2bPaQ/bzDkOMdp3LnHJcEV183K/c9+0Q8GDwhz49ek8Re70ZSuc8p3zS/w/4pAank1MCUoNTglJDU0NSwlPCU/SkRKZEpUYejD8Ucik2OS44/mJB0IDExMenAwYTk+ENxsHfkpJantRwZSX9/DJnBnimfZZLt9Vfs8eycstzmE09Ozp1aP0OXJ3JW85zNeb/8xIIThWUXmi8OFL2+9KMEX8pXplxudtmjIgL2kIKrtVXt1SM1b2t/XsPXczfIXNe9YXuTdCuyMa3p9O1yOIJ1tgzffd26cO9JW017Zof/fYNO3s71rvHu6z3HH5B79R9yPfz+aKCv4nFyv+OA1BPUk4nB+qH0YfcRuafop5Oj9WOZ4+Rn5hPykzzPGV7QvGR4xTelMe01c+r1yKzoXPY7MJ/xnn/x8ceMJZsvot+olld+fFpdWPuw8XVn/SVAJ2QOjSPcEB+QQcgVVAqaFV2CUcI8gm+0GxQFOC3cFOVRKnmqV/gswh7CIvUFGltaKtouuuP0ngxyjCjGEaZy5jgWS1Ye1mW2h+zFHHGcVlyi3BD3BM913hy+QH4jAQGBTfge1SScJxIlai0mKrYuPihRLhkvZSnNJ/1Zpl32hJyXvLT8qkIHHB/slFmVJ1WKVIlq/GrT6kUaHns49oxpntKy0iZoD+nk65L0JPW+6t8xSDO0MGI0mjQuheOFvOmqWZv5UQsrS2b4PlFiRbaWtv5m02ybbGdoT2nf73DC0d6JxWnC+aKLt6uo60e3W+6H9pl5MHu8ge8BaUQnb0kSgjThc8M31y/E3zxAgkxF/hD4JOhGcF5IbKhzmHo4R/jG/lcR7ZGlUenR5BjLWLk45ri1+JmEhwcaEguSjhwMT3Y/ZHpYOUUglT4NSvt8ZC599uj8sY8ZXzK/Z/3M3jyOyMHk4k4QTtKeYjzNcoY9j/ss3znB8yL54gVShXIXFC+qFGlc0irWLTEvJZUdLi+63FoxcWXlKnOVYrVNTUhtZl3Ftc76qYb1Gyw3FW5ZNQY2Hbld3NxyZ7Tlcyv+nnCbTvu+jgP3z3bWdnV3v+j51kvzUOaRQ9+Rx60DmCeegz3D5iMzo4XjsRMJzy+/wk1Xvzn7dvB99Kecbzqr1dvrv/sb3XbBKANQrg0HBPjcsCsBoLQFzjNV4fOjHABrAgD2agBhnwCgl00Acjn/5/yA4MSTAtDCGacQUNj5nSMIpMC55E0wCD5BNJAcZA8lwDngQ2gZwYHQQwQiTiFaEQtIVqQxMhZZiXyOokUZoZLgnGwJzsMC4NxrFiOECcBUYT5hlbBJ2G4KWgp3ikqKHzgTXCHuC6UpZQnlBpUrVROeFZ+Af0kwIFRTM1Mfpv5E40kzRGtEe5dOma6eXpq+lkGG4TqjGmMHkznTOLM/8wpLLqs4axebNzsEe6kexyxnJpcs1yh3Mo8ozzDvQT4Jvmf8xwTUBBYELwjZCGOFW0ViRGVFF8Uqxf0lRCQWJGukIqXVZBAyfbLn5HzkFRSQCiOKl5USlK1VhFU2VcfUGtSPawTtMdMU18JrfdQe1mnSvaSXoR9l4GVoaaRvrGWiZqpoJmcuayFrKbdX3krZWsNG19bUzs7e0yHEMckp17ncpcV1zG15H7OHuifJ6zix1fuLj6gvye+S/ysydyApqCYEhLqF3dsvFVEeJR59J9YlHpNwPzH3YPAh9xS3NP/0tGPVmS/+Ys1xPFFwaujMyjnefKvC9IudxRSlNuUlFT+u2lU31DHVJ15/fcuq6c4dsbvn2yg7EjuXew72bvXt7x8aFBgmPs0Zq352e/LGi5JXh6btX3O/eTWX/85qfut99QfnT6il2i/O31DL9T+Iq4w/e9dTN3V34gcE0IAKMAJeIAN04dUPAUdBKWgHMxAakoBsoUQ4+x9DYBBycG6fhWhGLCJ5kPbILGQnchOljopFNaJW0BroZHQXhoBxxJTAq66J/Qs7RaFIkUExjdPAncetUrpRtlGJUOVQ/cQH4McJZoRWamXqOhpJmipaKdoGOnW6Tnob+mmGSEYKxmImDXi14+AM8wFrDJsQ2zj7XxyGHJucd7gSuDW4N3k6ebP5HPkF+D8L3BfMEwoS1hfhEvkp+kzsjvhFiVhJKylxaaz0O5le2Vq50/JJCmRFJyVjZTUVaVVhNV51Tg32PRyaPFpC2lI6KroGevb6fgYJhjlGucanTc6ZXjSrMK+3aLXs2/vC6rMN2pbTTsXexiHcMdepwXnUZcNNxN1mX7JHnec0kcnbnHTE557vmr9GQCL5XhAq2CLkTOh0uOz+wxHDUaLwiTQZpxKfl7CS6J50P1ny0LkUTGps2vt04tFnGfaZg9nWf43kuOROnSSf1swTPseQjyxYvfCl6FPxl9LVy6grTFfFqw1qfa4dbbh241Uj3W2TO2l3u9qoOuw7L3a/6mV+ZPg4YCBpMG04+WnAmP4zwkTv8+iXjK9KpgVnCt5gZ/3mWt8R5u0Wzrzv/4D6qPzJeyn787UvI1+/LtN/l/phvEJcPfDz5Frl+r2N0c2FnfVHwLufHvDBe98M+MA7vwR0g0WICdKFwqESaBSBR2gjohE1iHdIYaQv8gpyEaWASkQ9QDOj/dC3MdQYX8w9LAc2Ab5zalGU4Qi4A7iPlCTK51TOVGN4N/wMIYSwTp1LI0bTTUumo6O7Sx/GIMwwzVjC5M8sz7zB0sGayebALsS+wtHPWcl1lJvMY8WryifMzyKAF8QIIYXRIpSijGJ84goS5pJkqQzpGpkR2XV5YQUbxYNKVcrPVCnUVNR9Nc7s6dJc1hbWcdbN0mvT/24oaRRgfNXkg5mCeZJF715Wq0DrVltGuxD7HkdBpxTnaVd9t/J9OI8wz1GilnelD7Nvqt/XAF9yTxBfcFLIZNie8OIIbGRY1GSMaWxzvFRCaSJHUl4yw6FTKUyp+Uf406uPqWR0ZzlmLxw/lMt2ouGU7uk7eUpnG87L5l8vVL7QUqR/6XGJa+l8eUIF4UrpVY2q0ZrIOvpr1xucrm/evNxo3bTRXNPi0Up/r7c95f6ezm/d1Q+CHyr3QY/7By4MkocVRpZHa8f3TaAmC18IvyybYpmOnel7wzprPZf6tvzdvflHCwPvHyze/VD8Mf2T85Lo0rfP9V9Cvwp9ffLtwLLg8t3vjt+Xfhxewa2cWGVfLfhJ/zNzDVqLX5tdt1y/ucG1cWRjflN3M3/z65bl1uXt9Y/0U5DfOT4gvB4A6JdbW1+FAcCeBGDjxNbWWsnW1kYpnGw8B6AtePd/n52zhhaAwp5t1N1ZVfzf/7/8D1Dc0yxKbLuXAAABnGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj4xNTA8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+ODI8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4Kcq7SjAAADiBJREFUeAHtXAt4TEcbfs9uko0Q6ke1jfudCnFrm/xFLqVIVbSlLi2euhR1v0eqIkKq4hqibu2jVKtoCEERUSFpXeLWoGmIS6IuUSREsmt3/5nZ659uctZptrvLzPPYmTPfzHe+884733xnzohwr1CjBU8cgTJGQFbG+rg6jgBDgBOLE8EmCHBi2QRWrpQTi3PAJghwYtkEVq6UE4tzwCYIcGLZBFaulBOLc8AmCHBi2QRWrpQTi3PAJghwYtkEVq6UE4tzwCYIuNhEq52VCio1oFRBeExy+o1do2G5plolO1v27Nz+6SGWWgPhkRJCkVJHpmdnDB3ySZ2fWMQbCQ+LIBQSQvHkMAg4NbGYhyoo5B7KYehkMsRpiSXkP+JeyjSODldySmLJ7j8kwfljhwOTG2RCwOm2GzipTIPnyCWnIhZd/rincmQ6mWxzGmKxQJ2/+ZlGzsFLzkEsuqVA3/54choEHCp4L7fvFNx+yQAyrgO383UgVvME6lWHqmUdFLZv5jTAPuuGCo7w/woZob45CNy8X/p4EJKp3vWVTDD+Sad0eMtSandiVYzdDWHbUd0zNasBVaeWKPKpC/ULlVmdy6UbUJy4CJfD54kn+1PX7k0f5A/w15Wf4JcT6wnA+odN7Uosc1KpxgajILjt3x5HdifPuLNeLvEMXL46oGsjgVycWH+D12YVdgve6fJn8FSFUR9YJBU7pWD2FwAeBbWAclpPHRg/nYJ78jmrgVHdvoaszEvIyjL8y0YeOfzwNCet+goimzfHzstkm8ZCEq4moXWLnth31bLcQherqk6mnYDdgnc3GlORRD1VUZv6rEx/3JPOQpFwAjifTa7IkZcGL0IV6I1CvyasTZF3bcg+CmSey3VrqpXxlgqHZnyMCRn3mA7zn3Grd2Pga7XMq56q8m2CYVEJE0ipVkKrzUCeqmwf+cD+vbCLx6LeigXqJKYyX/48V++FIupH4MwVwjiCBj1PdT4Hrsv3oMLGQ8anp54LjV5kb47Wei3Xl1yhbv8Zfj6VjpPH03AoKQHTO5XHkmFjcSr/6f67KO5yhRE7Wxeot7p/7559iMW2FMgT0kDdkKinkm1ONVzqc8F4LSSkwT3lgvH68etNWdk17ZKxTqwgQAGFnLRSKOBZtQ56j57NZuy56/o9srsZ+GH+BLTyfhkte4chIf2WSWXRX9izMpzJ6PKxbEsqSPTH0vWD6zFq1gps+3oWk7foPRo/njHrS1r9nrgJk3v5MPkn8zfgkpHMShwneqM37sD2JROZvM+IT3Eoy7Q8KW+exdpZnxh1x6Vm6u9MMvUDHNm4DP2IzdTu8JXxyC4wTRQFBBxN+h6LhrfV3Tt6M3KLTN2Lly4f3IQxejvHr4pHLpnbT5J+P09eskiyi8di+1Tk5vTtz5DY8me4KCF3PXDWKFG+XFNXzrpprLOmYD5379zIYV0qepDaIhKPtH8H89YrMWfxYkxudgCf9gkwxidJUcGYvvw0ps6LxdzxPmSgh8Bn6RHWX5mXjiNbliHsmCfmx3yBjzTJmN0/AAkXdeS4HD8NfcZF4GGnCKyMiYTLuij0+u9onNMT4M7vu/Ft1DRMvN8M0fNmoHpyHCaELGaDSuOkL4L6Iia9JubErMCUl3MRMawHlhzTEffg5CCMiloB/7mxWDlvPLYvC0Wn6CQjFBVJKX7hHKjfmIvomSOQsi4cQeO3wRK3LidEoufoCMiJndHzpuBgTCj8p1pua7xBsUJOzjVWY58YS7/5adhSYJawmKqYlaaJpxNk3jA2UBuOGd8hJx2sTK5HzmP/0RdBwb6TeRTTo76Eq3wsXq0pw+X4FYiT+WL9LzFo5iFAG+QL+WZfjNybjuDB1Qhx8lF30jL06daG9O6IGgpPbHkgGAfIRT4Ce2NHoRqRBrVvDqFlMMbGpaLb+PqInb4T9cesRuwwP2bpK8m10K/DAKz8ORNLutYmXxU0yB8Yg8xJgUz+apVH6Dg0BbfIAY5qNy9gq6DFuBkj0M27ErT+reGGGXhUQEmrRHm/kYgcEoLgZvTYdUdse5iO9+acxLWwQNQgNdSr9luyC5MCa5NSZyR6eSBoWBgOXXsb/qTGkCiBY6d+j7phm7Cob3NWnVzDBR0+WIe0uz3gW9m0ehj6WMrz83R+3D7EsmTRv1Cn1mzA5MEbjHdykX+EXSeGoSqpuXm9gByPT8Ha+TMZ8TyRj/UyDaomZkI5rC26jPLB1gUD0GJXICb17o7Xu45EeGV3vS4lNI29WD9aIchro2Xn8ih/KQ+q3BzsI8T4NKiVvi3JKntj0H89MPyPW4xYVPBGE70HJmXP51+iVWThJjsttdphikaGL/r5YfebQ9Cnqz8Cpy1CVb3rbdfzXRzbtRVjZi5C8gVdFC4TApBPSElfzYpI8F6v3vNUHUtVvLxYnqckPstsvRLycpFN7MyMW4mFGZXJ03viwW/fklBBhaxbhYRY5fQarMvsQyz6mYbssstv3IXaq4rO0qZkftGg3TzRSWLutRq8YJTKb+t36auUN9aJFTTt5+BobAgZMCWSwjticpwS98kAVJUrkZPxKwShEZo0bGIkyNSZr8Ddw5sNcNvhG5Dofwz7fj6E7bPGY9EsoHvUJkS8pZvdxe+trUhGjYRuygLdp6k8OtBmSeshg9s9Q5RGyGi2NpkfshbwH/RNP4FWqftx+PB+RIz7gGmJ3JKCbo3l2PFJAGal+GDy519iRKPncGXnbIR9pSOl8XZWxEmqe7mg0VGT5s1Qr0ElnSduOAVti9zQoophAhk1lljwrFiRBe/2IVYjMiMJsRSnslCgJ1ZRcBsoihOrmPl028GQ3NJ1aznqVjdUPUHuhsARC6DeOhQLvnsLsYO80dg/ALJEAV369YPRd5DXccjdyLS/jh++3IFa/Yfh/Y/bkX+j8RMhZuj63xDGiOVGX+qN99fiL1ze8gDqLoBrrSbopBVw6o9soHFD1kar/hOJex8iYFYDY5+SCqqrx7EqLgu9x/bCEN9uGDKGxIJtgrE27RqC6yiQeLgAfZZHok9HHQ4eXmSCwhQe0OD9dgGlqs7jKPN1ZGYvMWaT1kVvp3u7bgghy7MhUcfmZh6YGgQl5F5eNe33Vqh8rREzy3XfaaN5hQHe0PTyNV7rCqYn1wa3Nu5lURn7xENyVet6uqZP+Kut7ofVg33wy8LPkHpXizqvdoFaE4+uI2NxOjMbWekHMLZlK7yzNQNaFxWOrF6KwZ8twumsbORcOI0LJOZSG2dyeWjPzcbU71KRczULPy2ZiaWCBpMGBpC30NroPaQyDoWGYF1iOi5lncHGyb3Y8tj3ddP+XYnmq+9gzZpwhC+Nx6WbubiQdpLFXDU9yWi7VEA9Qpx1m7bi1/TzOLZjOUIidhLPS1YEfaLx5Kr+g5Bw5iKyzuzGpPfDWVzZoc7/L210+Q4Z8Bx2TOmGVbvS2HMc+HosfNsNxUUrPJ7hfo2bNmVFu3isR518wDZIz2XDI+G4cS8rf2hnuJMN0dI2SKnV9NMO+25IllRrTzy4egqgDsg8tR0civZr3sfC9SnYPMYfyZsXIOy9iRiUvJw1azBoLlaFNCIxExC9YxXCun9MZGuZTNlhML6N6MGWSYNOzY8j8NZcXZzTPfwbDCLBNk1tR+/GgnLhmDiuNxaTa5ngh8hN0ehQ3SzIYS3Nf3RuwrXum4iLmUbe1kKRslon9xs4FzO6Eu9H7Prwq0j8OjgMw4nNVG9I5+aI35eLW+SNsx5lFUkNO9XGp/3fZmW5/G2s2T+ULfc6S8mySfTQ5DdxD6IUMxE69UOsINc0NJi9YSXq6+WskchPq9ZtkEQ2SO32rZCdaJi/nZlJP+mY774bbKefdIR7DwyXLFecvQK3z+NYWTW8s9XEoh2s/VaoLKLLmsLyEkBkymKyy/ET0GNPB5wm8Ruo3IX0tTQYjNlkabUkY09U+g+zy5Ju4lHonCGaS9ZN7q18rCXPZMW6RvU9LoIbuZcUW+kmaWlTpvSn/IdS6rW0Ia8wLe6hG5jnKq5S60pGQGZ6zaWeykAqkI/Q1nqr4nrFrin4JcYVJcjkdwp1URaVl0QcGq+VJBMzisiZXZb6kzp2T0syg15yb6tIRdtTfZSApekz6LWQU69ll6XQYEveyK7MJdOP0a5LElCJxFzFj83I/npQZsdmDPct69ytfAM0aPdcWat1an12WwrNUeMH/czReDrKDkEsA5SMYDY8mmxtjGWwh+fSEXAoYpX4GOQ/U8jukiDe7GxWiW1LEXBilQJOGYvsFrw/0XPIZNB6WL/7+0S6eWObIOAcxCKPri1Hdrfd2Qu1TYDgSssWAachFn1srSfZLXaz64ts2aL/FGtzKmLRcdBUIh+dObkcnpJORywDufiy6NjcckpiUUjpsqitQJZGs515x4b62bLOaYnFyEUCek3lCjyod0DOOn8kTLciqPci59b5H7d1HIY5P7EMWMoJwSq4s38l/TluQ1Oe2x6Bp4dYZlixUxHkZITpmKCZkBf/FQScOsb6VxDiN5GEACeWJNh4JzEEOLHEEOJySQhwYkmCjXcSQ4ATSwwhLpeEACeWJNh4JzEEOLHEEOJySQhwYkmCjXcSQ4ATSwwhLpeEACeWJNh4JzEEOLHEEOJySQhwYkmCjXcSQ4ATSwwhLpeEACeWJNh4JzEEOLHEEOJySQhwYkmCjXcSQ4ATSwwhLpeEACeWJNh4JzEEOLHEEOJySQhwYkmCjXcSQ4ATSwwhLpeEACeWJNh4JzEEOLHEEOJySQhwYkmCjXcSQ4ATSwwhLpeEACeWJNh4JzEEOLHEEOJySQhwYkmCjXcSQ+B/ltGVRV74p2sAAAAASUVORK5CYII=");
        return createToken(claims, userDetails.getUsername());
    }

    private String createToken(Map<String, Object> claims, String subject ) {

        return Jwts.builder().setClaims(claims).setSubject(subject).setIssuedAt(new Date(System.currentTimeMillis()))
                .setExpiration(new Date(System.currentTimeMillis() + 1000 * 60 * 60 * 10))
                .signWith(SignatureAlgorithm.HS256, SECRET_KEY).compact();
    }

    public Boolean validateToken(String token, UserDetails userDetails) {
        final String username = extractUsername(token);
        return (username.equals(userDetails.getUsername()) && !isTokenExpired(token));
    }
}
